<script>
  /**
   * ğŸ  HomeView.vue - ä¸»é é¢çµ„ä»¶ (Main Home Page Component)
   *
   * åŠŸèƒ½èªªæ˜ï¼š
   * 1. ğŸ—ºï¸ æ•´åˆåœ°åœ–çµ„ä»¶å’Œæ§åˆ¶é¢æ¿ï¼Œæä¾›å®Œæ•´çš„åœ°åœ–å±•ç¤ºç•Œé¢
   * 2. ğŸ”— é€£æ¥æ•¸æ“šå­˜å„²å’Œåœ°åœ–çµ„ä»¶ï¼Œå¯¦ç¾æ•¸æ“šèˆ‡è¦–åœ–çš„ç¶å®š
   * 3. ğŸš€ ç®¡ç†åœ°åœ–å¯¦ä¾‹çš„ç”Ÿå‘½é€±æœŸï¼Œç¢ºä¿åœ°åœ–æ­£ç¢ºåˆå§‹åŒ–å’Œå°èˆª
   * 4. ğŸ“± æä¾›éŸ¿æ‡‰å¼ä½ˆå±€ï¼Œé©é…ä¸åŒè¨­å‚™å’Œè¢å¹•å°ºå¯¸
   *
   * æ¶æ§‹èªªæ˜ï¼š
   * - å®¹å™¨å±¤ï¼šæä¾›æ»¿ç‰ˆä½ˆå±€å®¹å™¨
   * - åœ°åœ–å±¤ï¼šMapTab çµ„ä»¶è² è²¬åœ°åœ–æ¸²æŸ“å’Œäº’å‹•
   * - ç‹€æ…‹å±¤ï¼šé€é Pinia ç®¡ç†å…¨å±€ç‹€æ…‹
   *
   * è¨­è¨ˆç†å¿µï¼š
   * - ç°¡æ½”çš„å–®é é¢è¨­è¨ˆ
   * - åœ°åœ–ç‚ºä¸»è¦å…§å®¹ï¼Œç„¡å¤šé¤˜ UI å…ƒç´ 
   * - è‡ªå‹•åŒ–åœ°åœ–å°èˆªå’Œåˆå§‹åŒ–
   */

  // ğŸ”§ Vue Composition API å¼•å…¥
  import MapTab from '../tabs/MapTab.vue';
  import { useDataStore } from '@/stores/dataStore.js';
  import { onMounted } from 'vue';

  export default {
    name: 'HomeView',

    /**
     * ğŸ§© çµ„ä»¶è¨»å†Š (Component Registration)
     * è¨»å†Šæœ¬é é¢ä½¿ç”¨çš„å­çµ„ä»¶
     */
    components: {
      MapTab, // åœ°åœ–æ¨™ç±¤é çµ„ä»¶
    },

    /**
     * ğŸ”§ çµ„ä»¶è¨­å®šå‡½æ•¸ (Component Setup)
     * ä½¿ç”¨ Composition API è¨­å®šé é¢å±¤ç´šçš„ç‹€æ…‹ç®¡ç†å’Œé‚è¼¯
     */
    setup() {
      // ğŸ“¦ ç²å–æ•¸æ“šå­˜å„²å¯¦ä¾‹ (Get Data Store Instance)
      const dataStore = useDataStore();

      /**
       * ğŸ—ºï¸ è¨­å®šåœ°åœ–å¯¦ä¾‹ (Set Map Instance)
       * å°‡åœ°åœ–çµ„ä»¶å‰µå»ºçš„åœ°åœ–å¯¦ä¾‹å‚³éçµ¦æ•¸æ“šå­˜å„²ï¼Œç”¨æ–¼å¾ŒçºŒçš„å°èˆªæ“ä½œ
       *
       * @param {Object} map - åœ°åœ–å¯¦ä¾‹å°è±¡ï¼ŒåŒ…å« SVGã€æŠ•å½±ã€è·¯å¾‘ç­‰ D3.js å…ƒç´ 
       */
      const setMapInstance = (map) => {
        console.log('ğŸ  [HomeView] æ¥æ”¶åœ°åœ–å¯¦ä¾‹:', map);
        dataStore.setMapInstance(map);
      };

      /**
       * ğŸš€ çµ„ä»¶æ›è¼‰å¾ŒåŸ·è¡Œ (Component Mounted)
       * åœ¨åœ°åœ–çµ„ä»¶æº–å‚™å°±ç·’å¾Œï¼Œè‡ªå‹•å°èˆªåˆ°å°ç£
       */
      onMounted(() => {
        console.log('ğŸ  [HomeView] çµ„ä»¶å·²æ›è¼‰ï¼Œæº–å‚™å°èˆªåˆ°å°ç£');
        // å»¶é²åŸ·è¡Œï¼Œç¢ºä¿åœ°åœ–å¯¦ä¾‹å·²æº–å‚™å°±ç·’
        setTimeout(() => {
          dataStore.navigateToTaiwan();
        }, 100);
      });

      // ğŸ“¤ è¿”å›éŸ¿æ‡‰å¼æ•¸æ“šå’Œå‡½æ•¸çµ¦æ¨¡æ¿ä½¿ç”¨ (Return Reactive Data and Functions)
      return {
        setMapInstance, // åœ°åœ–å¯¦ä¾‹è¨­å®šå‡½æ•¸
      };
    },
  };
</script>

<template>
  <!-- ğŸ  HomeView.vue - ä¸»é é¢æ¨¡æ¿ (Main Home Page Template) -->
  <!-- æä¾›æ»¿ç‰ˆç„¡é‚Šè·çš„ä½ˆå±€ï¼Œåœ°åœ–ä½”æ»¿æ•´å€‹è¦–çª— -->
  <div id="app" class="d-flex flex-column vh-100">
    <!-- ğŸ“± ä¸»è¦å…§å®¹å€åŸŸ (Main Content Area) -->
    <!-- ä½¿ç”¨ flex-grow-1 è®“å…§å®¹å€åŸŸä½”æ»¿å‰©é¤˜ç©ºé–“ -->
    <!-- overflow-hidden é˜²æ­¢å…§å®¹æº¢å‡º -->
    <!-- position-relative ç‚ºå­å…ƒç´ æä¾›å®šä½ä¸Šä¸‹æ–‡ -->
    <div class="flex-grow-1 overflow-hidden position-relative">
      <!-- ğŸ—ºï¸ åœ°åœ–çµ„ä»¶ (Map Component) -->
      <!-- ç›£è½ map-ready äº‹ä»¶ï¼Œç•¶åœ°åœ–æº–å‚™å°±ç·’æ™‚æ¥æ”¶åœ°åœ–å¯¦ä¾‹ -->
      <MapTab @map-ready="setMapInstance" />
    </div>
  </div>
</template>

<style>
  /**
   * ğŸ¨ HomeView.vue - ä¸»é é¢æ¨£å¼ (Main Home Page Styles)
   *
   * å¼•å…¥å…±ç”¨æ¨£å¼è¡¨ï¼Œç¢ºä¿èˆ‡æ‡‰ç”¨ç¨‹å¼æ•´é«”è¨­è¨ˆä¿æŒä¸€è‡´
   * å¤§éƒ¨åˆ†æ¨£å¼å·²æ•´åˆè‡³ common.css ä¸­çµ±ä¸€ç®¡ç†
   */

  /* ğŸ“¦ å¼•å…¥å…±ç”¨æ¨£å¼è¡¨ (Import Common Stylesheet) */
  @import '../assets/css/common.css';

  /* ğŸ“± é é¢ç‰¹å®šæ¨£å¼ (Page-Specific Styles) */
  /* ç›®å‰ç„¡éœ€é¡å¤–çš„é é¢ç‰¹å®šæ¨£å¼ï¼Œæ‰€æœ‰æ¨£å¼å·²æ•´åˆè‡³ common.css */
</style>
